# Автотесты на pytest и unittest для мини-проектов: сайта публикации новостей и агрегатора заметок.

## Тесты на unittest для проекта YaNote
### В файле test_routes.py:
Главная страница доступна анонимному пользователю.<br>
Аутентифицированному пользователю доступна страница со списком заметок notes/, страница успешного добавления заметки done/, страница добавления новой заметки add/.<br>
Страницы отдельной заметки, удаления и редактирования заметки доступны только автору заметки. Если на эти страницы попытается зайти другой пользователь — вернётся ошибка 404.<br>
При попытке перейти на страницу списка заметок, страницу успешного добавления записи, страницу добавления заметки, отдельной заметки, редактирования или удаления заметки анонимный пользователь перенаправляется на страницу логина.<br>
Страницы регистрации пользователей, входа в учётную запись и выхода из неё доступны всем пользователям.
### В файле test_content.py:
отдельная заметка передаётся на страницу со списком заметок в списке object_list в словаре context;<br>
в список заметок одного пользователя не попадают заметки другого пользователя;<br>
на страницы создания и редактирования заметки передаются формы.
### В файле test_logic.py:
Залогиненный пользователь может создать заметку, а анонимный — не может.<br>
Невозможно создать две заметки с одинаковым slug.<br>
Если при создании заметки не заполнен slug, то он формируется автоматически, с помощью функции pytils.translit.slugify.<br>
Пользователь может редактировать и удалять свои заметки, но не может редактировать или удалять чужие.

## Тесты на pytest для проекта YaNews.<br>
### В файле test_routes.py:
Главная страница доступна анонимному пользователю.<br>
Страница отдельной новости доступна анонимному пользователю.<br>
Страницы удаления и редактирования комментария доступны автору комментария.<br>
При попытке перейти на страницу редактирования или удаления комментария анонимный пользователь перенаправляется на страницу авторизации.<br>
Авторизованный пользователь не может зайти на страницы редактирования или удаления чужих комментариев (возвращается ошибка 404).<br>
Страницы регистрации пользователей, входа в учётную запись и выхода из неё доступны анонимным пользователям.
### В файле test_content.py:
Количество новостей на главной странице — не более 10.<br>
Новости отсортированы от самой свежей к самой старой. Свежие новости в начале списка.<br>
Комментарии на странице отдельной новости отсортированы в хронологическом порядке: старые в начале списка, новые — в конце.<br>
Анонимному пользователю недоступна форма для отправки комментария на странице отдельной новости, а авторизованному доступна.
### В файле test_logic.py:
Анонимный пользователь не может отправить комментарий.<br>
Авторизованный пользователь может отправить комментарий.<br>
Если комментарий содержит запрещённые слова, он не будет опубликован, а форма вернёт ошибку.<br>
Авторизованный пользователь может редактировать или удалять свои комментарии.<br>
Авторизованный пользователь не может редактировать или удалять чужие комментарии.

##  Автор
[@renzhin](https://github.com/renzhin)

### Используемые технологии
•   Python 3.9<br>
•   Django 3.2.15<br>
•   Pytest 7.1.3<br>
•   Unittest<br>
•   SQLite3<br>

## Как запустить проект:

```
Dev
 └── django_testing
     ├── ya_news
     │   ├── news
     │   │   ├── fixtures/
     │   │   ├── migrations/
     │   │   ├── pytest_tests/   <- Директория с тестами pytest для ya_news
     │   │   ├── __init__.py
     │   │   ├── admin.py
     │   │   ├── apps.py
     │   │   ├── forms.py
     │   │   ├── models.py
     │   │   ├── urls.py
     │   │   └── views.py
     │   ├── templates/
     │   ├── yanews/
     │   ├── manage.py
     │   └── pytest.ini
     ├── ya_note
     │   ├── notes
     │   │   ├── migrations/
     │   │   ├── tests/          <- Директория с тестами unittest для ya_note
     │   │   ├── __init__.py
     │   │   ├── admin.py
     │   │   ├── apps.py
     │   │   ├── forms.py
     │   │   ├── models.py
     │   │   ├── urls.py
     │   │   └── views.py
     │   ├── templates/
     │   ├── yanote/
     │   ├── manage.py
     │   └── pytest.ini
     ├── .gitignore
     ├── README.md
     ├── requirements.txt
     └── structure_test.py

```

Клонировать репозиторий и перейти в него в командной строке:

```
git clone git@github.com:renzhin/tests_django.git
```

```
cd tests_django
```

Cоздать и активировать виртуальное окружение в Windows:

```
python -m venv venv
```

```
source venv/Scripts/activate
```

Установить зависимости из файла requirements.txt:

```
python -m pip install --upgrade pip
```

```
pip install -r requirements.txt
```

Выполнить миграции:

```
python manage.py migrate
```

Для проектов YaNote и YaNews принцип запуска идентичен.<br>
Перейти в папку соответствубщего проекта ya_news или ya_note и запустить:

```
python manage.py runserver
```

### Пример заполнения файла с переменными окружения.env:
````
SECRET_KEY=django-insecure-1234567891011121223321231232323232321323
ALLOWED_HOSTS='11.22.33.44 127.0.0.1 localhost domain.name'
````